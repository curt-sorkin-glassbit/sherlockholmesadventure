<!DOCTYPE html>
<html>

<head>
    <title>3-Coin Canvas</title>
    <style>
        canvas {
            border: #333 10px solid;
        }

        body {
            padding: 50px;
        }
    </style>
</head>


<body>

    <canvas id="myCanvas" width="550px" height="350px"></canvas>

    <!--
    <canvas id="myCanvas2" width="550px" height ="350px"></canvas>
    -->

    <script>


        function sprite(options) {

            var that = {};

            that.context = options.context;
            that.width = options.width;
            that.height = options.height;
            that.totalFrames = options.totalFrames;
            that.image = options.image;

            that.shift = 0;
            that.currentFrame = 1;

            that.render = function () {
                // clear the canvas
                that.context.clearRect(120, 25, 300, 300);
                //draw each frame + place them in the middle
                that.context.drawImage(that.image, that.shift, 0, that.width, that.height,
                    120, 25, that.width, that.height);

                if (that.currentFrame == that.totalFrames) {
                    that.shift = 0;
                    that.currentFrame = 1;
                }
                else{
                that.shift += that.width + 1;
                that.currentFrame++;
                }

                requestAnimationFrame(that.render);

            };

            return that;
        }


        var canvas = document.querySelector("#myCanvas");
        var context = canvas.getContext("2d");
        var myImage = new Image();
        myImage.src = "https://www.kirupa.com/stuff/sprites_blue.png";
        myImage.addEventListener("load", loadImage, false);

        function loadImage(e) {
            var mySprite = new sprite({"context": context, 
            "width": 300, 
            "height": 300, 
            "totalFrames": 24,
            "image": myImage});
            mySprite.render();
        }

        /*
        var canvas2 = document.querySelector("#myCanvas2");
        var context2 = canvas2.getContext("2d");
        var myImage2 = new Image();
        myImage2.src = "https://www.kirupa.com/stuff/sprites_blue.png";
        myImage2.addEventListener("load", loadImage2, false);



        // do we need to methods? No! We could pass the canvas as separate param!
        function loadImage2(e) {
            var mySprite = new sprite({"context": context2, 
            "width": 300, 
            "height": 300, 
            "totalFrames": 24,
            "image": myImage2});
            mySprite.render();
        }

        */


    </script>

</body>

</html>